# 프롬프트 리라이터 - 실행 체크리스트

## 🎯 의사결정 요약

| 항목 | 권장값 | 근거 |
|------|-------|------|
| **추천 시나리오** | **Scenario C** | 낮은 위험도 + 점진적 개선 |
| **변경 내용** | ai_score_cut: 0.70 → 0.67 | 실제 신호 평균(0.685) 고려 |
| **예상 효과** | intents/min: 1.11 → 1.33 (+20%) | 기준 0.03 하향으로 추가 신호 포함 |
| **거절률 변화** | 20% → 22% (거의 변화 없음) | 거절 필터 효율성 유지 |
| **위험도** | 🟢 낮음 | 다른 파라미터 유지, 롤백 용이 |

---

## ✅ 체크리스트

### Phase 1: 승인 단계 (지금)
- [ ] **리라이터 제안서 검토** (PROMPT_REWRITER_PROPOSAL.md)
- [ ] **감사 보고서 검토** (PROMPT_AUDIT_REPORT.md)
- [ ] **경영진 승인 획득**
  - Scenario C 적용 결정
  - 100-200 신호 수집 기간 예정
  - 정량 평가 후 Scenario A/B 고려

### Phase 2: 파라미터 변경 (수동)
- [ ] **변경 전 백업**
  ```
  strategy_params.json (2026-01-28_REWRITE_C 로 백업)
  ```

- [ ] **파라미터 수정**
  ```json
  현재: "ai_score_cut": 0.70
  변경: "ai_score_cut": 0.67
  
  버전: "2026-01-28_REWRITE_C"
  ```

- [ ] **변경 검증**
  - [ ] JSON 문법 확인 (jq 또는 Python json 검증)
  - [ ] app64/signal_engine.py가 정상 로드하는지 테스트
  - [ ] 변경사항 git commit (optional)

### Phase 3: 신호 수집 (90-180분)
- [ ] **수집 시작**
  - 목표: 100-200개 신호
  - 기준 intents/min: 1.33 이상
  - 거절률: 22% ±3%

- [ ] **중간 평가 (30분 경과)**
  - [ ] 현재까지 신호 개수 확인
  - [ ] intents/min 계산 (예상: 1.33 이상)
  - [ ] 거절 사유 분석
  - → 기대치 부합 시 계속 진행

- [ ] **정량 평가 (120분 경과)**
  - [ ] 총 신호 개수: 160개 이상?
  - [ ] intents/min 재계산
  - [ ] AI 점수 분포 분석
  - [ ] 거절 사유 상세 분석

### Phase 4: 데이터 분석

**분석 1: 신호 빈도 개선**
```
확인 사항:
□ intents/min이 1.33 이상인가?
  - 예상: 1.11 → 1.33
  - 초과 달성 시: Scenario A 재고 고려
  - 미달 성 시: "ai_score_cut 조정만으로 부족" 결론

□ 신호 개수가 충분한가?
  - 목표: 120분 당 160개 이상
  - 미달 시: 수집 기간 연장
```

**분석 2: AI 점수 분포**
```
확인 사항:
□ 0.67-0.70 범위 신호 얼마나 생성?
  - 예상: 기존 대비 20% 정도 추가
  - 이들의 평균 점수: 약 0.68 정도
  
□ 0.67-0.70 신호의 거절률?
  - 예상: 전체 거절률(22%)과 유사
  - 만약 거절률이 50% 이상이면: "품질 필터 작동"
```

**분석 3: 거절 사유 분석**
```
현재 (ai_score_cut=0.70):
  - TTL_EXPIRED: 50% (신호 유효시간 초과)
  - COOLDOWN: 50% (포지션 쿨다운)

예상 (ai_score_cut=0.67):
  - TTL_EXPIRED: 약 45% (조금 감소)
  - COOLDOWN: 약 55% (조금 증가)
  - 이유: 더 많은 신호로 인한 필터 부하 증가

확인:
□ TTL_EXPIRED 비율이 50% 수준 유지되는가?
□ COOLDOWN이 50% → 55% 범위로 변했는가?
□ 거절 패턴이 기대와 일치하는가?
```

### Phase 5: 최종 의사결정

**결과별 대응**:

```
Case A: intents/min ≥ 1.50 (기대 이상)
  ✅ Scenario C 성공
  → 다음: Scenario A(0.65) 재고 고려
  → 승인: 추가 신호 생성 가능성 검증

Case B: 1.30 < intents/min < 1.50 (기대 달성)
  ✅ Scenario C 성공
  → 다음: 현재 상태 유지 또는 점진적 개선
  → 승인: 안정적 운영 가능

Case C: intents/min ≤ 1.30 (기대 미달)
  ⚠️ Scenario C 부분 실패
  → 다음: Scenario A(0.65) 또는 B 검토
  → 결론: "ai_score_cut 조정만으로 부족"
  → 의사결정: 복합 조건 전체 재검토 필요
```

### Phase 6: 보고서 작성
- [ ] **데이터 분석 보고서 작성**
  - intents/min 변화 그래프
  - AI 점수 분포 히스토그램
  - 거절 사유별 비율
  - Scenario A/B 재고 여부 권장

- [ ] **이해관계자 보고**
  - 결과 요약 (숫자로 표현)
  - 다음 단계 권장안
  - 추가 변경 필요 여부

---

## 📊 추적 양식

### 10분 주기 진행 상황 기록

```
수집 시작 시간: ________

|시간|누적신호|intents/min|BUY|SELL|TTL_EXP|COOLDOWN|비고|
|----|--------|-----------|---|----|----|---------|--|
|+10분|__개|___.__ |__%|__%|__%|__%||
|+20분|__개|___.__ |__%|__%|__%|__%||
|+30분|__개|___.__ |__%|__%|__%|__%|중간평가|
|...|
|+120분|__개|___.__ |__%|__%|__%|__%|정량평가|
```

### AI 점수 분포 기록 (수집 완료 후)

```
범위          | 개수 | 비율  | 거절률
--------------|------|-------|--------
0.55-0.60    | __ | __% | __%
0.60-0.65    | __ | __% | __%
0.65-0.70    | __ | __% | __% ← 새로 추가된 영역
0.70-0.75    | __ | __% | __%
0.75-0.90    | __ | __% | __%
--------------|------|-------|--------
합계          | __ | 100% | __%
```

---

## 🚫 금지 사항

```
❌ 손익 기반 조정
   - "이 신호로 돈 벌었나?" 기반 파라미터 변경 금지
   - 로그 통계만 기반 의사결정

❌ 자동 적용
   - 이 체크리스트는 "제안용"
   - 실제 변경은 수동으로만 진행
   - 승인 없이 파라미터 변경 금지

❌ 다중 파라미터 동시 변경
   - 한 번에 1개 파라미터만 변경
   - 현재: ai_score_cut만 변경
   - vol_spike/book_ratio 함께 변경 금지

❌ 과도한 해석
   - intents/min 변화만 기반으로 평가
   - 신호 품질(AI 점수)까지 함께 확인 필수
   - "신호 많다 = 좋다" 절대 금지

❌ 데이터 10개로 결정
   - 현재 데이터: 10개 신호 (불충분)
   - 최소: 100-200개 신호 기반 평가
   - 통계적 유의성 확보 필수
```

---

## ✨ 성공 기준

### 최소 요구사항 (모두 충족해야 Scenario C 성공)

```
1. intents/min ≥ 1.30
   - 현재: 1.11
   - 목표: 1.33 이상
   - 최소: 1.30 (20% 개선)

2. 거절률 ≤ 25%
   - 현재: 20%
   - 예상: 22%
   - 최대: 25% (과도한 부하 방지)

3. AI 점수 평균 ≥ 0.68
   - 현재: 0.685
   - 기대: 0.68 이상 (약간의 저하 허용)
   - 최소: 0.67 (품질 기준)

4. BUY 비율 유지
   - 현재: 50%
   - 기대: 48-52% (균형 유지)
```

### 우수 달성 기준 (하나 이상 충족 시 Scenario A 재고)

```
1. intents/min ≥ 1.50
   - 기대(1.33) 대비 13% 초과 달성
   - Scenario A(0.65)로 추가 개선 가능 신호

2. 거절률 < 20%
   - 현재(20%) 이하 유지
   - 거절 필터 부하 없음
   - Scenario A로 더 공격적 조정 가능

3. AI 점수 평균 ≥ 0.69
   - 품질 향상 (예상과 다름)
   - 더 공격적 조정 안전성 증명
```

---

## 🔄 Scenario C 실패 시 (Plan B)

만약 intents/min이 1.30 이하로 머물면:

```
원인 분석:
1. ai_score_cut 변경이 실제로 반영되지 않음
   → app64/signal_engine.py 재확인
   → load_params() 함수가 업데이트된 파일 로드하는가?

2. 신호 점수 분포가 예상과 다름
   → AI 신호 생성 로직 재검토
   → 실제 0.67-0.70 신호가 생성되고 있는가?

3. 0.67-0.70 신호가 모두 거절됨
   → 거절 필터 과도함
   → TTL_EXPIRED 비율 재확인
   → 신호 유효시간(5초) 너무 짧을 수 있음

대응:
□ Scenario A 검토 (ai_score_cut 0.65)
□ Scenario B 검토 (vol_spike/book_ratio 완화)
□ TTL 기간 연장 검토 (5초 → 10초)
```

---

## 📝 최종 서명

```
의사결정 날짜: ____________
결정자: ____________________
이메일: ____________________

체크리스트 완료 날짜: ____________
검증자: ____________________
이메일: ____________________
```

---

**이 체크리스트는 Scenario C 적용 후의 실행 가이드입니다.**
**모든 변경은 로그 통계만 기반으로 진행하며, 손익 예측은 엄격히 금지됩니다.**

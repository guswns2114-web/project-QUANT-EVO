# QUANT-EVO Prompt Quality Auditor: 최종 감사 보고서

**감사일**: 2026-01-28  
**대상 버전**: test_v01  
**감사자 역할**: 프롬프트 구조적 문제 식별  
**제약**: 손익 예측 금지, 자동 수정 금지, 제안만 제시

---

## 📊 감사 대상 데이터

```
분석 기간: 9.0분
신호 생성: 10개
실행: 8개 (80%)
거절: 2개 (20%)

신호율: 1.11 signals/min (목표: 10-15)
평균 AI 점수: 0.6850
BUY 비율: 50%
실행 신호의 AI 점수: 0.6550
거절 신호의 AI 점수: 0.7000
```

---

## 🔴 **문제 요약**

### 핵심 문제: **신호 생성 빈도 극도로 낮음**

```
현재:      1.11 signals/min
목표 범위: 10-15 signals/min
갭:        약 9배 부족
```

**심각도**: 🚨 **CRITICAL**
- 9분에 10개 신호만 생성 (분당 1개 수준)
- 거래 기회 심각하게 부족
- 현재 설정으로는 실전 거래 불가능

---

## 🔍 **원인 가설 분석**

### [가설 1] 신호 신뢰도 기준 (ai_score_cut) 과도히 높음
**영향도**: 🟡 **MEDIUM**

```
현재 설정:   ai_score_cut = 0.70
실제 신호:   평균 점수 = 0.6850
상황:        신호 점수가 기준(0.70)에 미달
```

**분석**:
- 기준(0.70)을 만족하지 못하는 신호는 생성되지 않음
- 실제 생성되는 신호의 평균(0.6850)이 기준과 거의 같음
- 기준을 조금 낮추면 신호 생성 증가 가능

**증거**:
```
생성 신호의 점수 분포: 0.55 ~ 0.89
점수 표준편차: 0.0908
→ 신호 품질이 다양하며, 낮은 점수 신호는 현재 필터됨
```

---

### [가설 2] 시장 조건 필터 과도히 엄격함
**영향도**: 🟢 **LOW**

```
현재 설정:
- vol_spike_min = 2.0 (변동성 스파이크 2배)
- book_ratio_min = 1.3 (호가 레시오 1.3배)
```

**분석**:
- 이들 조건은 **특정 시장 상황**에서만 만족
- 볼륨 급증이나 호가 불균형이 없으면 신호 생성 불가
- 시뮬레이션 환경에서 이런 조건이 자주 만족되는가?

**평가**:
- 현재 데이터 부족으로 확실하지 않음
- 하지만 기준이 현실적이라면 영향도는 낮을 것

---

### [가설 3] 프롬프트 로직 자체가 신호를 제한함
**영향도**: 🟡 **MEDIUM**

```
복합 조건들:
- VWAP 이상 가격 요구
- 최대 3개 심볼만 거래
- 30초 window 분석
- buy_ratio_min = 0.65 (매수 비율 65% 이상 요구)
```

**분석**:
- 이들이 **동시에** 만족되어야만 신호 생성
- 각각의 조건이 개별적으로는 합리적이지만
- **복합적으로는** 신호 기회를 크게 제한

**예시**:
```
VWAP 위에 있고 (조건 1)
그 심볼이 3개 중 하나이고 (조건 2)
30초 내에 매수 비율 65%를 만족하고 (조건 3)
AI 점수가 0.70 이상 (조건 4)
→ 모두 만족해야만 신호 생성

조건 각각의 만족률이 50%라면 → 0.5^4 = 6.25% 확률
```

---

## 💡 **조정 제안 시나리오**

### **Scenario A: ai_score_cut 완화**

**제안**:
```
변경 전: ai_score_cut = 0.70
변경 후: ai_score_cut = 0.65
```

**근거**:
- 현재 신호의 평균 점수가 0.6850
- 0.05만 낮춰도 추가 신호 생성 가능
- 거절 필터가 이들을 처리할 수 있음

**예상 효과**:
```
intents_per_minute: 1.11 → ~1.67 (+50%)
```

**장점**:
- ✅ 간단한 변경
- ✅ 측정 가능한 효과
- ✅ 필터로 품질 보정 가능

**위험**:
- ⚠️ 낮은 신뢰도 신호 증가
- ⚠️ 거절 필터에 의존 (필터 과부하)
- ⚠️ 너무 완화하면 노이즈 증가

---

### **Scenario B: 시장 조건 필터 완화**

**제안**:
```
변경 전:
  vol_spike_min = 2.0
  book_ratio_min = 1.3

변경 후:
  vol_spike_min = 1.7
  book_ratio_min = 1.2
```

**근거**:
- 신호 기회 확대를 위해 조건 완화
- 모의 거래 환경에서 조건이 과도히 엄격할 수 있음

**예상 효과**:
```
intents_per_minute: 1.11 → ~2.22 (약 2배)
```

**장점**:
- ✅ 더 많은 신호 생성 기회
- ✅ 다양한 시장 상황 포괄

**위험**:
- 🚨 변동성/호가 조건이 실제 시장 조건이라면 부적절
- ⚠️ 노이즈 신호 크게 증가
- ⚠️ 거절률 상승 (COOLDOWN, TTL)

---

### **Scenario C: 점진적 완화 (권장) 🌟**

**제안**:
```
변경 전: ai_score_cut = 0.70
변경 후: ai_score_cut = 0.67
```

**근거**:
- 작은 변화로 안정성 유지
- 데이터 수집 후 추가 평가 가능
- 과도한 변경 피함

**예상 효과**:
```
intents_per_minute: 1.11 → ~1.33 (+20%)
```

**장점**:
- ✅ 낮은 위험도
- ✅ 점진적 개선 가능
- ✅ 데이터 수집 계속 가능
- ✅ 필터 시스템 안정성 유지

**위험**:
- ⚠️ 제한적 개선 (여전히 목표 미달)
- ⚠️ 추가 조정 필요 가능성 높음

**권장 이유**:
```
"과도한 변경보다는 안정적 개선"
→ 100-200개 신호 수집 후 추가 평가
→ 필요시 Scenario A/B로 확대
```

---

## 📈 **시나리오별 예상 효과**

| 지표 | 현재 | Scenario A | Scenario B | Scenario C |
|------|------|-----------|-----------|-----------|
| **intents/min** | 1.11 | 1.67 | 2.22 | 1.33 |
| **증가율** | - | +50% | +100% | +20% |
| **신호 신뢰도** | 높음 | 중간 | 낮음 | 높음 |
| **필터 부하** | 낮음 | 중간 | 높음 | 낮음 |
| **위험도** | - | 중간 | 높음 | 낮음 |
| **권장도** | - | ⭐⭐ | ⭐ | ⭐⭐⭐ |

---

## ✅ **감사자의 최종 권장사항**

### 🎯 **즉시 조치 (검토 단계)**

1. **데이터 수집 계속**
   - 현재: 10개 신호 (9분)
   - 목표: 100-200개 신호 (90-180분)
   - 이유: 현재 데이터로는 신뢰도 낮음

2. **거절 신호 상세 분석**
   ```
   거절된 2개 신호 분석:
   - TTL_EXPIRED 1개: 신호 생성 후 5ms 내 필터되지 않음 ✅
   - COOLDOWN 1개: 포지션 쿨다운으로 거절 ✅
   → 거절 필터 정상 작동
   ```

3. **ai_score_cut의 실제 영향 측정**
   ```
   질문: 현재 기준(0.70)을 만족하지 못하는 신호가 몇 개인가?
   방법: 로그에서 기준 직상인 신호들(0.65-0.70) 개수 확인
   ```

### 📋 **권장 순서**

```
Step 1: Scenario C 적용 검토
        → ai_score_cut: 0.70 → 0.67로 조정
        → 이유: 낮은 위험도, 점진적 개선

Step 2: 100-200개 신호 수집
        → 변경 효과 측정
        → 새로운 intents/min 계산

Step 3: 재평가
        → 목표(10-15 signals/min)에 도달했는가?
        → 아니면 Scenario A/B 고려

Step 4: 최종 결정
        → 경영진 검토
        → 승인 후 적용
```

### 🚫 **금지 사항**

```
❌ 손익을 기반으로 파라미터 변경
   이유: 이 감사는 로그 통계만 기반. 단기 손익은 노이즈 가능성

❌ 한 번에 여러 파라미터 동시 변경
   이유: 어느 변경이 효과를 냈는지 알 수 없음

❌ 데이터 10개로 최종 결정
   이유: 통계적 유의성 부족

❌ 프롬프트 자동 수정 적용
   이유: 반드시 수동 검토 후 승인 필요

❌ "높은 신호율 = 좋은 프롬프트" 가정
   이유: 신호 품질도 함께 검토 필요
```

---

## 🔧 **구체적 검토 항목**

### 1단계: ai_score_cut의 실제 영향도 측정

**확인 질문**:
```
Q1: 현재 로그의 신호 점수 분포는?
    → 0.60~0.70 범위의 신호가 몇 개?
    → 만약 5개라면, ai_score_cut 완화의 효과는 최소 45% 증가

Q2: 기준(0.70)을 1단계 낮추면(0.67) 몇 개 신호 추가?
    → 시뮬레이션 환경에서 재계산 가능

Q3: 추가 신호들의 평균 점수는?
    → 0.67-0.70 신호들의 품질이 실행 신호(0.655)보다 나은가?
```

### 2단계: 거절 필터의 충분성 확인

```
현재 거절 필터:
- TTL_EXPIRED (50%): 신호 유효시간 5ms 초과
- COOLDOWN (50%): 마지막 거래 후 쿨다운

검토:
- 거절 필터가 "나쁜 신호"를 걸러내는가?
- 거절된 신호(0.70)가 실행 신호(0.655)보다 높은 이유?
  → 필터 역전! (위험 신호)
```

### 3단계: 복합 조건의 영향 분석

```
현재 조건:
1. VWAP 이상 가격
2. 최대 3개 심볼
3. 30초 window
4. 매수 비율 65%
5. AI 점수 0.70

실행 가능한 검토:
- 어떤 조건이 가장 제한적인가?
- 조건 제거 시나리오 (예: VWAP 제거 시 신호율 변화?)
```

---

## 📌 **감사 결론**

### 상태: 🚨 **조정 필요**

**현재 프롬프트**:
- ✅ 신호 품질은 안정적 (AI 점수 일관)
- ✅ BUY/SELL 균형 잡힘
- ✅ 필터 작동 정상
- ❌ **신호 생성 빈도 극도로 낮음** (1.11/min → 10-15/min 필요)

**주요 원인**:
1. 🟡 ai_score_cut이 신호 평균 점수와 거의 같음 (상단 제약)
2. 🟡 복합 조건이 동시 만족 필요 (컴포운드 확률)
3. 🟢 시장 조건 필터는 현실적 수준

**권장 액션**:
1. ✅ **Scenario C** (ai_score_cut 0.70 → 0.67) 검토
2. ✅ 100-200개 신호 수집하여 효과 측정
3. ✅ 목표 미달 시 Scenario A/B 고려
4. ✅ 매 단계마다 로그 통계만 평가 (손익 제외)

---

## 🎓 **감사자의 최종 의견**

```
현재 프롬프트는 "구조적으로 건전"하지만,
"보수적인 기준의 조합"으로 신호 생성이 저해되고 있습니다.

해결책:
1. ai_score_cut을 현재 신호 평균에 맞춰 조정
2. 거절 필터가 이를 충분히 보정 가능 (현재 80% 실행률)
3. 점진적 완화로 위험 최소화

주의:
- 손익 기반 결정 절대 금지
- 데이터 충분히 수집 후 재평가
- 경영진 승인 필요
```

---

**감사 완료**: 2026-01-28  
**다음 감사**: 100-200개 신호 수집 후 재평가 예정  
**담당**: Prompt Quality Auditor (AI)
